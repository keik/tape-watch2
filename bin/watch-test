#!/usr/bin/env node

var sw = require('spawn-wrap')
var foreground = require('foreground-child')

var wrapper = require.resolve('./wrap')

var argv = require('minimist')(process.argv.slice(2), {
  boolean: ['h', 'v', 'w'],
  alias: {h: 'help', o: 'outpfile', v: 'verbose', w: 'watch'}
})

if (argv.h || argv._.length === 0)
  return process.exit(_help())

sw([wrapper], {OPTS: JSON.stringify(argv)})

foreground(argv._, function(done) {
  console.log('done')
  return done()
})

function _help() {
  console.log(`Usage: tape-watch [tests (glob)] {OPTIONS}

     --help, -h  Show this mesage.

  --verbose, -v  Run as verbose mode.
`)
}
