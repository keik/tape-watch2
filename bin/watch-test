#!/usr/bin/env node

var fs = require('fs')
var foreground = require('foreground-child')
var path = require('path')
var sw = require('spawn-wrap')

var wrapper = require.resolve('./wrap')

var argv = require('minimist')(process.argv.slice(2), {
  boolean: ['h', 'v'],
  alias: {h: 'help', v: 'verbose'}
})

if (argv.h || argv._.length === 0)
  return _help()

sw([wrapper], {OPTS: JSON.stringify(argv)})

foreground(argv._, function(done) {
  console.log('done')
  return done()
})

function _help() {
  fs.createReadStream(path.join(__dirname, 'usage'))
    .pipe(process.stdout)
}
